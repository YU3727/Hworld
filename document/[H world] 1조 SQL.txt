-- H WORLD TABLE DESCRIPTION
-- COMMONCODE
CREATE TABLE COMMONCODE(
	TYPE VARCHAR(30),
	CODE VARCHAR(30),
	VALUE VARCHAR(200),
	NOTE VARCHAR(4000)
)


-- APPLICATIONFORM
CREATE TABLE APPLICATIONFORM(
	APPNUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	NAME VARCHAR(200),
	RRNF VARCHAR(88),
	RRNL VARCHAR(88),
	ADDRESS1 VARCHAR(50),
	ADDRESS2 VARCHAR(200),
	ADDRESS3 VARCHAR(200),
	PLANNUM VARCHAR(50),
	PHONENUM VARCHAR(200),
	DISKIND INT(11), -- 공시지원금0, 12개월선택약정1, 24개월선택약정2
	PHONESUBPRICE INT(11),
	STARTDATE DATE,
	DIRECTNAME VARCHAR(200),
	DIRECTCODE VARCHAR(200)
);


-- MEMBER
CREATE TABLE MEMBER(
	MEMBERNUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	EMAIL VARCHAR(200),
	PW VARCHAR(88),
	NAME VARCHAR(200),
	ADDRESS1 VARCHAR(50),
	ADDRESS2 VARCHAR(200),
	ADDRESS3 VARCHAR(200),
	RRNF VARCHAR(88),
	RRNL VARCHAR(88),
	JOINDATE DATE,
	MEMBERSTATE INT(11), -- 탈퇴-1, 휴면0, 정상1
	ADMINCHECK INT(11), -- 관리자0, 회원1
	TEL VARCHAR(200),
	OWNCHECK INT(11) -- 타통신사0, 자사1
)


-- DISCODE
CREATE TABLE DISCODE(
	DISCODE INT(11) AUTO_INCREMENT PRIMARY KEY,
	DISPERCENT FLOAT(2,1)
)


-- PLAN
CREATE TABLE PLAN(
	PLANNUM VARCHAR(50) PRIMARY KEY,
	DISCODE INT(11),
	PLANNAME VARCHAR(200),
	PLANPRICE INT(11),
	DATACAPACITY INT(11),
	CATEGORYCODE VARCHAT(50), -- G, S, T, Z, W, H, E
	PLANEXPLAIN VARCHAR(4000),
	PLANEXPLAINS VARCHAR(200),
	DISABLED INT(11) -- 불가0, 가능1
)


-- EPLAN
CREATE TABLE EPLAN(
	EXTRAPLANNUM VARCHAR(50) PRIMARY KEY,
	EXTRAPLANNAME VARCHAR(200),
	EXTRAPRICE INT(5),
	EXTRAPLANEXPLAIN VARCHAR(4000),
	EXTRAPLANEXPLAINS VARCHAR(200),
	EXTRAPLANEXPLAINM VARCHAR(1000),
	CATEGORYCODE VARCHAR(200)
)


-- TELEPHONE_EPLAN 
CREATE TABLE TELEPHONE_EPLAN(
	EXTRAPLANNUM VARCHAR(50),
	SERIALNUM INT(11)
)


-- TELEPHONE
CREATE TABLE TELEPHONE(
	SERIALNUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	PLANNUM VARCHAR(50),
	MEMBERNUM INT(11),
	APPNUM INT(11),
	PHONENUM VARCHAR(200),
	CONTRACTDATE DATE,
	EXPIREDATE DATE,
	STARTDATE DATE,
	ENDDATE DATE,
	KINGCHECK INT(11), -- 나머지회선0, 대표회선1(1개만)
	PHONEORIPRICE INT(11),
	PHONESUBPRICE INT(11),
	PHONETOTALPRICE INT(11),
	PHONEBALANCE INT(11),
	STOPSTARTDATE DATE,
	STOPENDDATE DATE,
	DISKIND INT(11), -- 할인X-1, 공시지원금0, 12개월선택약정1, 24개월선택약정2
	DIRECTNAME VARCHAR(200),
	DIRECTCODE VARCHAR(200),
	PLANCHANGEDATE DATE,
	CANCELPRICE INT(11),
	NUMBERCHANGEDATE DATE -- 30일에 1회만 가능
)


-- PAYMENTDETAILS 
CREATE TABLE PAYMENTDETAILS(
	BILLNUM INT(11), AUTO_INCREMENT PRIMARY KEY,
	SERIALNUM INT(11),
	PLANNUM VARCHAR(50),
	BILLCHECK INT(11), -- 미청구0, 청구1
	PAIDCHECK INT(11), -- 미납0, 납부1
	PHONEPAYPRICE INT(11),
	PHONESPLITTAX INT(11),
	PHONESPLITPRICE INT(11),
	DISPLANPRICE INT(11),
	EPLANPRICE INT(11),
	TOTALPRICE INT(11),
	OVERDUEPRICE INT(11),
	PAYMAXDATE DATE,
	USEDATE DATE,
	PAYMONTH VARCHAR(50),
	BFPLANPRICE INT(11),
	PLANCHANGEDATE DATE,
	CANCELPRICE INT(11),
	PAIDDATE DATE,
	DISPRICE INT(11)
)


-- DIRECT 
CREATE TABLE DIRECT(
	DIRECTCODE VARCHAR(200) PRIMARY KEY,
	DIRECTNAME VARCHAR(200),
	DIRECTCONTENTS VARCHAR(4000),
	DIRECTPRICE INT(11),
	DIRECTSTOCK INT(11),
	CATEGORYCODE VARCHAR(200), -- P
	BRANDCODE VARCHAR(200), -- B
	COLORCODE VARCHAR(200), -- C
	SAVECAPACITY VARCHAR(200), -- V
	UPLOADDATE DATE
)


-- ORDER
CREATE TABLE ORDERS(
	ORDERNUM VARCHAR(400) PRIMARY KEY,
	MEMBERNUM INT(11),
	ORDERDATE DATE,
	ORDERSTATE INT(11), -- 완료0, 환불1
	ORDERRECEIVER VARCHAR(50),
	ORDERADDRESS1 VARCHAR(50),
	ORDERADDRESS2 VARCHAR(200),
	ORDERADDRESS3 VARCHAR(200),
	ORDERTELNUM VARCHAR(200)
)


-- ORDERDIRECT 
CREATE TABLE ORDERDIRECT(
	DIRECTCODE VARCHAR(200),
	ORDERNUM VARCHAR(400),
	MEMBERNUM INT(11),
	ORDERAMOUNT INT(11)
)


-- CART
CREATE TABLE CART(
	CARTNUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	DIRECTCODE VARCHAR(200),
	MEMBERNUM INT(11),
	CARTAMOUNT INT(11)
)


-- PAY 
CREATE TABLE PAY(
	PAYNUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	ORDERNUM VARCHAR(400),
	MEMBERNUM INT(11),
	ORDERFINALPRICE INT(11),
	PAYDATE DATE
)


-- REVIEW 
CREATE TABLE REVIEW(
	NUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	ORDERNUM VARCHAR(400),
	MEMBERNUM INT(11),
	CONTENTS VARCHAR(4000),
	RATE FLOAT(2,1),
	REGDATE DATE
)


-- QNA 
CREATE TABLE QNA(
	NUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	MEMBERNUM INT(11),
	ORDERNUM VARCHAR(400),
	SLICEDCODE VARCHAR(200),
	SERIALNUM INT(11),
	TITLE VARCHAR(200),
	CONTENTS VARCHAR(4000),
	REPLY VARCHAR(4000),
	REGDATE DATE,
	STATE INT(11), -- 삭제-1, 답변대기중0, 답변완료1
	CATEGORYCODE VARCHAR(50), -- IQ
	FILEPATH VARCHAR(200),
	REPLYDATE DATE
)


-- NOTICE 
CREATE TABLE NOTICE(
	NUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	MEMBERNUM INT(11),
	NOTICECHECK INT(11), -- 미확인0, 확인1
	TITLE VARCHAR(200),
	CONTENTS VARCHAR(4000),
	REGDATE DATE,
	FILEPATH VARCHAR(200)
)


-- ARCHIVE 
CREATE TABLE ARCHIVE(
	NUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	MEMBERNUM INT(11),
	TITLE VARCHAR(200),
	CONTENTS VARCHAR(4000),
	REGDATE DATE,
	FILEPATH VARCHAR(200)
)


-- LOGINLOG 
CREATE TABLE LOGINLOG(
	LOGNUM INT(11) AUTO_INCREMENT PRIMARY KEY,
	MEMBERNUM INT(11),
	LOGIP VARCHAR(50),
	LOGDATE DATE
)



-- H WORLD CONSTRAINTS
-- APPLICATIONFORM 
ALTER TABLE APPLICATIONFORM ADD CONSTRAINT AF_PN_UQ UNIQUE (PHONENUM);


-- MEMBER
ALTER TABLE MEMBER ADD CONSTRAINT MEMBER_EM_UQ UNIQUE(EMAIL);


-- PLAN
ALTER TABLE PLAN ADD CONSTRAINT PLAN_DC_FK FOREIGN KEY (DISCODE) REFERENCES DISCODE(DISCODE);


-- TELEPHONE_EPLAN
ALTER TABLE TELEPHONE_EPLAN ADD CONSTRAINT TE_EP_FK FOREIGN KEY(EXTRAPLANNUM) REFERENCES EPLAN(EXTRAPLANNUM);
ALTER TABLE TELEPHONE_EPLAN ADD CONSTRAINT TE_SN_FK FOREIGN KEY(SERIALNUM) REFERENCES TELEPHONE(SERIALNUM);


-- TELEPHONE
ALTER TABLE TELEPHONE ADD CONSTRAINT TP_PN_UQ UNIQUE (PHONENUM);
ALTER TABLE TELEPHONE ADD CONSTRAINT TP_PN_FK FOREIGN KEY (PLANNUM) REFERENCES PLAN(PLANNUM);


-- PAYMENTDETAILS
ALTER TABLE PAYMENTDETAILS ADD CONSTRAINT PD_SN_FK FOREIGN KEY(SERIALNUM) REFERENCES TELEPHONE(SERIALNUM);
ALTER TABLE PAYMENTDETAILS ADD CONSTRAINT PD_PN_FK FOREIGN KEY(PLANNUM) REFERENCES PLAN(PLANNUM);


-- ORDERS
ALTER TABLE ORDERS ADD CONSTRAINT OD_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- ORDERDIRECT
ALTER TABLE ORDERDIRECT ADD CONSTRAINT OD_DC_FK FOREIGN KEY(DIRECTCODE) REFERENCES DIRECT(DIRECTCODE);
ALTER TABLE ORDERDIRECT ADD CONSTRAINT OD_ON_FK FOREIGN KEY(ORDERNUM) REFERENCES ORDERS(ORDERNUM);
ALTER TABLE ORDERDIRECT ADD CONSTRAINT OD_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- CART
ALTER TABLE CART ADD CONSTRAINT CART_DC_FK FOREIGN KEY(DIRECTCODE) REFERENCES DIRECT(DIRECTCODE);
ALTER TABLE CART ADD CONSTRAINT CART_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- PAY
ALTER TABLE PAY ADD CONSTRAINT PAY_ON_FK FOREIGN KEY(ORDERNUM) REFERENCES ORDERS(ORDERNUM);
ALTER TABLE PAY ADD CONSTRAINT PAY_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- REVIEW
ALTER TABLE REVIEW ADD CONSTRAINT REVIEW_ON_FK FOREIGN KEY(ORDERNUM) REFERENCES ORDERS(ORDERNUM);
ALTER TABLE REVIEW ADD CONSTRAINT REVIEW_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- QNA
ALTER TABLE QNA ADD CONSTRAINT QNA_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- NOTICE
ALTER TABLE NOTICE ADD CONSTRAINT NOTICE_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- ARCHIVE
ALTER TABLE ARCHIVE ADD CONSTRAINT ARCHIVE_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);


-- LOGINLOG
ALTER TABLE LOGINLOG ADD CONSTRAINT LL_MN_FK FOREIGN KEY(MEMBERNUM) REFERENCES MEMBER(MEMBERNUM);
